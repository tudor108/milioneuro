<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 880 360" fill="none">
  <defs>
    <pattern id="grid" width="20" height="20" patternUnits="userSpaceOnUse">
      <rect width="20" height="20" fill="#F6F8FB" />
      <circle cx="1" cy="1" r="1" fill="#E4E8F0" />
    </pattern>
    <filter id="card" x="-10%" y="-20%" width="120%" height="140%">
      <feDropShadow dx="0" dy="10" stdDeviation="18" flood-color="#152238" flood-opacity="0.15" />
    </filter>
    <style>
      .label-main { font: 600 18px 'Inter', Arial, sans-serif; fill: #1D2840; letter-spacing: 0.05em; }
      .label-sub { font: 500 12px 'Inter', Arial, sans-serif; fill: #7A869C; letter-spacing: 0.04em; }
      .label-pill { font: 600 12px 'Inter', Arial, sans-serif; fill: #1D2840; letter-spacing: 0.18em; }
      .connector { stroke: #9BA7BD; stroke-width: 4; stroke-linecap: round; }
    </style>
    <marker id="arrow" markerWidth="14" markerHeight="14" refX="10" refY="7" orient="auto">
      <path d="M0,0 L14,7 L0,14 L4,7 Z" fill="#7384A4" />
    </marker>
  </defs>

  <rect width="880" height="360" rx="28" fill="#EEF2F9" />
  <rect x="24" y="24" width="832" height="312" rx="24" fill="url(#grid)" stroke="#DDE3F0" />

  <!-- Trigger -->
  <g filter="url(#card)">
    <rect x="68" y="135" width="170" height="100" rx="26" fill="#FFFFFF" stroke="#C3CCDA" stroke-width="2" />
    <circle cx="96" cy="185" r="18" fill="#FF7A74" opacity="0.25" />
    <path d="M96 190c-4.2 0-7.6-3.4-7.6-7.6v-2.8c0-4.2 3.4-7.6 7.6-7.6s7.6 3.4 7.6 7.6v2.8c0 4.2-3.4 7.6-7.6 7.6Zm0-4c2 0 3.6-1.6 3.6-3.6v-2.8c0-2-1.6-3.6-3.6-3.6s-3.6 1.6-3.6 3.6v2.8c0 2 1.6 3.6 3.6 3.6Zm0 10c-6.2 0-12.1 1.5-16.8 4.1 2-6.3 7.4-10.9 13.8-10.9h6c6.4 0 11.8 4.6 13.8 10.9-4.7-2.6-10.6-4.1-16.8-4.1Z" fill="#1D2840" opacity="0.65" />
    <text x="153" y="182" class="label-main" text-anchor="middle">When chat message</text>
    <text x="153" y="204" class="label-main" text-anchor="middle">received</text>
  </g>

  <!-- Agent -->
  <g filter="url(#card)">
    <rect x="288" y="108" width="220" height="156" rx="28" fill="#FFFFFF" stroke="#C3CCDA" stroke-width="2" />
    <path d="M338 182a18 18 0 1 1 36 0 18 18 0 0 1-36 0Zm18-26c-14.3 0-26 11.7-26 26v10h52v-10c0-14.3-11.7-26-26-26Z" fill="#27324B" opacity="0.75" transform="translate(32,-6)" />
    <text x="398" y="166" class="label-main" text-anchor="middle">AI Agent</text>
    <text x="398" y="190" class="label-sub" text-anchor="middle">Tools Agent</text>
    <g transform="translate(312 204)">
      <rect width="180" height="30" rx="15" fill="#F2F5FB" />
      <text x="90" y="20" class="label-sub" text-anchor="middle">Chat Model</text>
    </g>
    <g transform="translate(312 240)">
      <rect width="180" height="30" rx="15" fill="#F2F5FB" />
      <text x="90" y="20" class="label-sub" text-anchor="middle">Memory</text>
    </g>
    <g transform="translate(312 276)">
      <rect width="180" height="30" rx="15" fill="#F2F5FB" />
      <text x="90" y="20" class="label-sub" text-anchor="middle">Tool</text>
    </g>
  </g>

  <!-- If Node -->
  <g filter="url(#card)">
    <rect x="552" y="156" width="110" height="100" rx="24" fill="#FFFFFF" stroke="#C3CCDA" stroke-width="2" />
    <rect x="592" y="194" width="30" height="30" rx="8" fill="#E6F5EA" stroke="#6CC476" />
    <path d="M606 200c-1.1 0-2 .9-2 2v4h-4c-1.1 0-2 .9-2 2s.9 2 2 2h4v4c0 1.1.9 2 2 2s2-.9 2-2v-4h4c1.1 0 2-.9 2-2s-.9-2-2-2h-4v-4c0-1.1-.9-2-2-2Z" fill="#2F9E44" />
    <text x="607" y="180" class="label-main" text-anchor="middle">If</text>
  </g>

  <!-- Success -->
  <g filter="url(#card)">
    <rect x="694" y="94" width="150" height="110" rx="24" fill="#FFFFFF" stroke="#C3CCDA" stroke-width="2" />
    <circle cx="742" cy="134" r="26" fill="#F5FCFF" stroke="#C3CCDA" />
    <text x="769" y="188" class="label-main" text-anchor="middle">Success</text>
    <text x="769" y="210" class="label-sub" text-anchor="middle">Send message</text>
    <g transform="translate(726 120)">
      <path d="M21.7 5.3c.8-1.9 3.5-1.9 4.3 0l1.6 3.6a1 1 0 0 0 .9.6h3.9c2 0 2.8 2.5 1.2 3.6l-3.2 2.3a1 1 0 0 0-.4 1l1.2 3.7c.7 2-.1 3.1-2 2.2l-3.5-2a1 1 0 0 0-1 0l-3.5 2c-1.9 1-2.7-.2-2-2.2l1.2-3.7a1 1 0 0 0-.4-1l-3.2-2.3c-1.6-1.1-.9-3.6 1.2-3.6h3.9a1 1 0 0 0 .9-.6l1.6-3.6Z" fill="#2FB455" />
    </g>
  </g>

  <!-- Failure -->
  <g filter="url(#card)">
    <rect x="694" y="216" width="150" height="110" rx="24" fill="#FFFFFF" stroke="#C3CCDA" stroke-width="2" />
    <circle cx="742" cy="256" r="26" fill="#F5FCFF" stroke="#C3CCDA" />
    <text x="769" y="310" class="label-main" text-anchor="middle">Failure</text>
    <text x="769" y="332" class="label-sub" text-anchor="middle">Send message</text>
    <g transform="translate(726 242)">
      <path d="M25 7.8 15.3 26.2c-.7 1.5-2.9 1.5-3.6 0L2 7.8C1 5.9 2.4 4 4.5 4h17.5c2.1 0 3.5 1.9 2.5 3.8ZM12 11h2v6h-2v-6Zm2 10h-2v2h2v-2Z" fill="#F56464" />
    </g>
  </g>

  <!-- Connectors -->
  <path d="M238 184 H288" class="connector" marker-end="url(#arrow)" />
  <path d="M508 186 H552" class="connector" marker-end="url(#arrow)" />
  <path d="M662 198 C690 174 700 170 694 150" class="connector" marker-end="url(#arrow)" />
  <path d="M662 214 C690 238 700 242 694 262" class="connector" marker-end="url(#arrow)" />
</svg>
